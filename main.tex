\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\graphicspath{ {./images/} }

\title{Desarrollo de un instrumento musical digital}
\author{ Jesús Jiménez Sánchez }

\begin{document}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Objetivos
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Objetivos}\label{sec:Objetivos}
Objetivo General:

Objetivos específicos:
\begin{itemize}
    \item OB-E1: Planificación
    \item OB-E2:
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Introducción
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introducción}\label{sec:Introduccion}
Para empezar se decide entre hacer detección binaria de la entrada, es decir, si el parche ha sido golpeado o no, y
hacer que estas entradas sean concurrentes (al golpear dos parches, el sonido de ambos suena al mismo tiempo), o
hacer detección de distintos sonidos en un mismo parche, dependiendo de cómo se golpee el parche (en el centro, en
el lateral, con más o menos fuerza…) el sonido emitido es diferente.\newline
Se decide empezar con la primera alternativa y dejar la segunda para más adelante en caso de tener tiempo.

\subsection{Derechos de autor}
\subsubsection{¿Qué son los derechos de autor?}
Los derechos de autor son una serie de leyes que protegen la autoría de las obras. Estas pueden ser libros,
películas, obras de teatro, programas informáticos...\newline
Se cubren dos tipos de derechos: los derechos patrimoniales, que aseguran que el autor obtenga compensación
financiera, y los derechos morales, que cubren todo lo que no esté relacionado con los derechos patrimoniales, por
ejemplo, la prohibición de que se modifique la obra.\cite{derechos_ompi}

\subsubsection{Historia de los derechos de autor}
La historia de los derechos de autor comienza en 1710, cuando se publica el Estatuto de la Reina
Anna\cite{estatuto_anna} que fue el primer reglamento sobre los derechos de autor. En el momento de la publicación
de éste estatuto solo se contemplaban los derechos sobre los libros, pero en posteriores leyes se contemplan otros
usos, como cine, radio, fotografías o programas de ordenador.\newline
En la actualidad, los derechos de autor se protegen tanto con acuerdos y leyes internacionales, como leyes
nacionales.\newline
Desde 1974 en Estados Unidos con la CONTU\cite{contu} (Commission on New Technological Uses of Copyrighted Works) y
de 1991 en la Unión Europea con la Computer Programs Directive\cite{com_pro_dir}, se protegen los derechos de autor
de los programas informáticos.

\subsubsection{Origen de sonidos de batería}
Los sonidos de batería han sido obtenidos de Soundsnap\cite{soundsnap} y de la biblioteca de sonidos de GarageBand
para macOS\cite{garageband}

\subsection{Planificación}

 \subsubsection{A priori (optimista)}

 %% TODO: Mejorar predicción de tiempos a priori
 \begin{itemize}
    \item
        Programa que genere los sonidos de batería concurrentes: 1-2 meses
    \item
        Construcción de un prototipo de batería con sonidos concurrentes: 1-2 meses
    \item
        Añadir funcionalidad que genere diferentes sonidos de un mismo parche/platillo: 1 mes
    %% El programa tiene que diferenciar el lugar en el que se golpea el parche/platillo,
    %% lo que será la mayor dificultad
    \item
        Añadir sensores y conexiones para generar diferentes sonidos según dónde se golpee en el
        parche/platillo: 1-2 semanas
    \item
        Aplicación web para conectar dos baterías online: 1-2 meses
    \item
        Documentación: 3 semanas
\end{itemize}

 \subsubsection{A posteriori (en caso de haber diferencias)}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Diseño
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Diseño de la propuesta}\label{sec:Diseno}

 Aquí hay que detallar y justificar las decisiones que se tomen (hacer varias propuestas pero desarrollar solo la
 mejor) (siempre es bueno una tabla comparativa con pros y contras o ticks)

 \subsection{Librería de reproducción de sonido ¿?}
 \begin{itemize}
     \item
        playsound\cite{playsound}: No se usa porque es muy lento y el programa que queremos crear necesita ser lo
        más rápido posible.
     \item
        mpg123\cite{mpg123}: Librería y programa en C más rápido que playsound de Python. Tiene el problema de
        hacer que haya fallos de memoria cuando se usan hebras para reproducir varios sonidos al mismo tiempo, pero
        se soluciona utilizando procesos en su lugar.
 \end{itemize}

 \subsection{Otras librerías}
 \begin{itemize}
     \item
        Wiring Pi\cite{wiringPi}: Para realizar la conexión de sensores y botones a la Raspberry Pi se utiliza
        la librería wiringPi, que es la estándar en este tema.
 \end{itemize}

 \subsection{Problemas ¿?}
 \begin{itemize}
     \item
        Error de \textit{segmentation fault} que ocurría por utilizar hebras para reproducir
        varios sonidos al mismo tiempo, se solucionó cambiando las hebras por procesos.
     \item
        Relacionado con el problema anterior, intentando reproducir dos sonidos al mismo tiempo, para reducir
        la posibilidad de que el usuario toque dos intrumentos al mismo tiempo. En el modelo solo por procesos
        se editan los sonidos juntos para que no haya latencia al tocar dos a la vez, haciéndolo con hebras se
        ahorra el trabajo de editar los sonidos y no hay combinaciones no contempladas. Sin embargo, el sistema
        de reproducción de sonido del sistema operativo no permite reproducir sonidos mediante hebras, solo
        procesos.
 \end{itemize}

 \subsection{Decisiones ¿?}

    \subsubsection{if-else vs switch}
    Al pulsar una tecla, el número leído se envía a una función que selecciona qué sonido hay que reproducir en
    ese momento, dependiendo de qué sonido corresponda a ese número. Este proceso de selección se puede hacer
    con una estructura de \textit{if-else} anidados o con un \textit{switch-case}.\newline
    Para decir cuál de las dos soluciones se implementa en la versión final se realizó un test en el que cada
    vez se ejecutan más iteraciones del programa cambiando de sonido en cada una de ellas. Se empieza con 1
    iteración y se termina con 10000000 iteraciones.\newline
    \begin{figure}[ht]
        \centering
        \includegraphics[width=\textwidth]{grafica_if_switch}
        \caption{Gráfica comparativa if-else vs switch}
    \end{figure}
    \newline
    \begin{center}
        \begin{tabular}{ |c|c|c| }
            \hline
                iterations & if & switch \\
                \hline\hline
                1 & 0.000243 & 0.000270 \\
                \hline
                10 & 0.002797 & 0.002485 \\
                \hline
                100 & 0.027775 & 0.027261 \\
                \hline
                1000 & 0.260075 & 0.261464 \\
                \hline
                10000 & 0.431544 & 0.425668 \\
                \hline
                100000 & 1.368561 & 1.374575 \\
                \hline
                1000000 & 8.070825 & 7.560718 \\
                \hline
                10000000 & 79.199539 & 71.409653 \\
            \hline
        \end{tabular}
    \end{center}
    Como se puede ver en la gráfica, la diferencia no es apreciable hasta las 1000000 iteraciones, pero después
    pasa a casi 8 segundos de diferencia en 10000000 iteraciones. Por esta razón se ha decidido que la función
    utilice la estructura \textit{switch-case}.\newline
    Finalmente, debido a la manera en la que realizan las comprobaciones de qué botones y sensores son utilizados,
    aunque un \textit{switch-case} es más rápido, esta estructura se reserva para la versión del programa que
    reproduce los sonidos leyendo del teclado. En el programa que controla los sensores se utiliza una estructura
    \textit{if-else}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementación
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Implementación de la propuesta}\label{sec:Implementacion}

 Poner especial atención al proceso: dificultades y problemas encontrados y cómo se han solucionado

 \subsection{Coste y presupuesto}

  tabla con el coste de desarrollo (incluye tu mano de obra... etc.)

->  Identifica los aspectos éticos y sociales relacionados con la profesión

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Resultados y discusión
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Resultados y discusión}\label{sec:ResultadosDisc}

-> Identifica los aspectos éticos y sociales relacionados con la profesión


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Conclusiones
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusiones}\label{sec:Conclusiones}

 ¿se han satisfecho los objetivos? ¿el porqué? Como se ha visto en \ref{sec:ResultadosDisc}, los o...

-> Identifica los aspectos éticos y sociales relacionados con la profesión


\bibliographystyle{plain}
\bibliography{referencias}

\end{document}

